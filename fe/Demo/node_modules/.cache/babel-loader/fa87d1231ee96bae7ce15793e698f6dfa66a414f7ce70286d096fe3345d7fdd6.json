{"ast":null,"code":"import axios from \"axios\";\nimport Cookies from \"js-cookie\";\nconst baseUrl = \"http://localhost:8080\";\nclass CustomError extends Error {\n  constructor(status, message) {\n    super(message);\n    this.status = status;\n  }\n}\nconst setJwtCookie = jwt => {\n  const expirationDate = new Date();\n  expirationDate.setTime(expirationDate.getTime() + 15 * 60 * 1000);\n  Cookies.set(\"jwtToken\", jwt, {\n    expires: expirationDate\n  });\n};\nconst setJwtSession = jwt => {\n  sessionStorage.setItem(\"jwt\", jwt);\n};\nconst removeJwtSession = () => {\n  sessionStorage.removeItem(\"jwt\");\n};\nconst removeJwtCookie = () => {\n  if (Cookies.get(\"jwtToken\")) Cookies.remove(\"jwtToken\");\n};\nconst handleLoginSuccess = response => {\n  const jwt = response.data.token;\n  setJwtSession(jwt);\n  setJwtCookie(jwt);\n};\nconst clearSessionData = () => {\n  removeJwtSession();\n  removeJwtCookie();\n};\nexport const userLogin = async (email, password) => {\n  try {\n    const response = await axios.post(`${baseUrl}/api/auth/login?loginValue=${email}&password=${password}`);\n    if (response.status === 200) {\n      console.log(\"login success\");\n      handleLoginSuccess(response.data);\n      return response.data;\n    }\n    return response.data;\n  } catch (error) {\n    throw new CustomError(error.response.status, error.response.data.errors);\n  }\n};\nexport const userLogout = async token => {\n  try {\n    const response = await axios.get(`${baseUrl}/api/auth/logout`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    if (response.status === 200) {\n      clearSessionData();\n      console.log(\"logout success\");\n      return response.data;\n    }\n    return response.data;\n  } catch (error) {\n    throw new CustomError(error.response.status, error.response.data.errors);\n  }\n};","map":{"version":3,"names":["axios","Cookies","baseUrl","CustomError","Error","constructor","status","message","setJwtCookie","jwt","expirationDate","Date","setTime","getTime","set","expires","setJwtSession","sessionStorage","setItem","removeJwtSession","removeItem","removeJwtCookie","get","remove","handleLoginSuccess","response","data","token","clearSessionData","userLogin","email","password","post","console","log","error","errors","userLogout","headers","Authorization"],"sources":["C:/Users/Khanhhy/Documents/SWP391_SPR24_B3W_hollywood/fe/Demo/src/api/authApi.js"],"sourcesContent":["import axios from \"axios\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nconst baseUrl = \"http://localhost:8080\";\r\n\r\nclass CustomError extends Error {\r\n    constructor(status, message) {\r\n      super(message);\r\n      this.status = status;\r\n    }\r\n  }\r\n\r\n  const setJwtCookie = (jwt) => {\r\n    const expirationDate = new Date();\r\n    expirationDate.setTime(expirationDate.getTime() + 15 * 60 * 1000);\r\n  \r\n    Cookies.set(\"jwtToken\", jwt, { expires: expirationDate });\r\n  };\r\n  \r\n  const setJwtSession = (jwt) => {\r\n    sessionStorage.setItem(\"jwt\", jwt);\r\n  };\r\n\r\n  const removeJwtSession = () => {\r\n    sessionStorage.removeItem(\"jwt\");\r\n  };\r\n\r\n  const removeJwtCookie = () => {\r\n    if (Cookies.get(\"jwtToken\")) Cookies.remove(\"jwtToken\");\r\n  };\r\n  \r\n  const handleLoginSuccess = (response) => {\r\n    const jwt = response.data.token;\r\n    setJwtSession(jwt);\r\n    setJwtCookie(jwt);\r\n  };\r\n  const clearSessionData = () => {\r\n    removeJwtSession();\r\n    removeJwtCookie();\r\n  };\r\n\r\nexport const userLogin = async (email,password) => {\r\n    try {\r\n      const response = await axios.post(\r\n        `${baseUrl}/api/auth/login?loginValue=${email}&password=${password}`\r\n      );\r\n      if (response.status === 200) {\r\n        console.log(\"login success\");\r\n        handleLoginSuccess(response.data);\r\n        return response.data;\r\n      }\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new CustomError(error.response.status, error.response.data.errors);\r\n    }\r\n  };\r\n\r\n  export const userLogout = async (token) =>{\r\n    try {\r\n      const response = await axios.get(\r\n        `${baseUrl}/api/auth/logout`,{\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          }\r\n    });\r\n      if (response.status === 200) {\r\n        clearSessionData();\r\n        console.log(\"logout success\");\r\n        return response.data;\r\n      }\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new CustomError(error.response.status, error.response.data.errors);\r\n    }\r\n  }"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,OAAO,MAAM,WAAW;AAE/B,MAAMC,OAAO,GAAG,uBAAuB;AAEvC,MAAMC,WAAW,SAASC,KAAK,CAAC;EAC5BC,WAAWA,CAACC,MAAM,EAAEC,OAAO,EAAE;IAC3B,KAAK,CAACA,OAAO,CAAC;IACd,IAAI,CAACD,MAAM,GAAGA,MAAM;EACtB;AACF;AAEA,MAAME,YAAY,GAAIC,GAAG,IAAK;EAC5B,MAAMC,cAAc,GAAG,IAAIC,IAAI,CAAC,CAAC;EACjCD,cAAc,CAACE,OAAO,CAACF,cAAc,CAACG,OAAO,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;EAEjEZ,OAAO,CAACa,GAAG,CAAC,UAAU,EAAEL,GAAG,EAAE;IAAEM,OAAO,EAAEL;EAAe,CAAC,CAAC;AAC3D,CAAC;AAED,MAAMM,aAAa,GAAIP,GAAG,IAAK;EAC7BQ,cAAc,CAACC,OAAO,CAAC,KAAK,EAAET,GAAG,CAAC;AACpC,CAAC;AAED,MAAMU,gBAAgB,GAAGA,CAAA,KAAM;EAC7BF,cAAc,CAACG,UAAU,CAAC,KAAK,CAAC;AAClC,CAAC;AAED,MAAMC,eAAe,GAAGA,CAAA,KAAM;EAC5B,IAAIpB,OAAO,CAACqB,GAAG,CAAC,UAAU,CAAC,EAAErB,OAAO,CAACsB,MAAM,CAAC,UAAU,CAAC;AACzD,CAAC;AAED,MAAMC,kBAAkB,GAAIC,QAAQ,IAAK;EACvC,MAAMhB,GAAG,GAAGgB,QAAQ,CAACC,IAAI,CAACC,KAAK;EAC/BX,aAAa,CAACP,GAAG,CAAC;EAClBD,YAAY,CAACC,GAAG,CAAC;AACnB,CAAC;AACD,MAAMmB,gBAAgB,GAAGA,CAAA,KAAM;EAC7BT,gBAAgB,CAAC,CAAC;EAClBE,eAAe,CAAC,CAAC;AACnB,CAAC;AAEH,OAAO,MAAMQ,SAAS,GAAG,MAAAA,CAAOC,KAAK,EAACC,QAAQ,KAAK;EAC/C,IAAI;IACF,MAAMN,QAAQ,GAAG,MAAMzB,KAAK,CAACgC,IAAI,CAC9B,GAAE9B,OAAQ,8BAA6B4B,KAAM,aAAYC,QAAS,EACrE,CAAC;IACD,IAAIN,QAAQ,CAACnB,MAAM,KAAK,GAAG,EAAE;MAC3B2B,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;MAC5BV,kBAAkB,CAACC,QAAQ,CAACC,IAAI,CAAC;MACjC,OAAOD,QAAQ,CAACC,IAAI;IACtB;IACA,OAAOD,QAAQ,CAACC,IAAI;EACtB,CAAC,CAAC,OAAOS,KAAK,EAAE;IACd,MAAM,IAAIhC,WAAW,CAACgC,KAAK,CAACV,QAAQ,CAACnB,MAAM,EAAE6B,KAAK,CAACV,QAAQ,CAACC,IAAI,CAACU,MAAM,CAAC;EAC1E;AACF,CAAC;AAED,OAAO,MAAMC,UAAU,GAAG,MAAOV,KAAK,IAAI;EACxC,IAAI;IACF,MAAMF,QAAQ,GAAG,MAAMzB,KAAK,CAACsB,GAAG,CAC7B,GAAEpB,OAAQ,kBAAiB,EAAC;MAC3BoC,OAAO,EAAE;QACPC,aAAa,EAAG,UAASZ,KAAM;MACjC;IACN,CAAC,CAAC;IACA,IAAIF,QAAQ,CAACnB,MAAM,KAAK,GAAG,EAAE;MAC3BsB,gBAAgB,CAAC,CAAC;MAClBK,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;MAC7B,OAAOT,QAAQ,CAACC,IAAI;IACtB;IACA,OAAOD,QAAQ,CAACC,IAAI;EACtB,CAAC,CAAC,OAAOS,KAAK,EAAE;IACd,MAAM,IAAIhC,WAAW,CAACgC,KAAK,CAACV,QAAQ,CAACnB,MAAM,EAAE6B,KAAK,CAACV,QAAQ,CAACC,IAAI,CAACU,MAAM,CAAC;EAC1E;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}